{"id":184,"date":"2020-09-23T17:16:54","date_gmt":"2020-09-23T17:16:54","guid":{"rendered":"http:\/\/localhost\/?p=184"},"modified":"2020-09-23T17:29:51","modified_gmt":"2020-09-23T17:29:51","slug":"iot-esp8266-05-ngat-va-timer","status":"publish","type":"post","link":"http:\/\/localhost\/2020\/09\/23\/iot-esp8266-05-ngat-va-timer\/","title":{"rendered":"IOT-ESP8266: 05-Ng\u1eaft v\u00e0 timer"},"content":{"rendered":"\n<p>C\u00e1c ch\u01b0\u01a1ng tr\u00ecnh tr\u01b0\u1edbc ch\u00fang ta \u0111\u1ec1u vi\u1ebft theo d\u1ea1ng tu\u1ea7n t\u1ef1, ngh\u0129a l\u00e0 c\u00e1c c\u00e2u l\u1ec7nh s\u1ebd ch\u1ea1y l\u1ea7n l\u01b0\u1ee3t trong h\u00e0m loop, sau \u0111\u00f3 s\u1ebd ch\u1ea1y l\u1ea1i t\u1eeb \u0111\u1ea7u. Nh\u01b0ng trong c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh ph\u1ee9c t\u1ea1p v\u00e0 \u0111\u00f2i h\u1ecfi th\u1eddi gian \u0111\u00e1p \u1ee9ng th\u1eadt nhanh(nh\u01b0 nh\u1ea5n n\u00fat \u0111\u1ec3 \u0111i\u1ec1u khi\u1ec3n g\u00ec \u0111\u00f3) m\u00e0 trong ch\u01b0\u01a1ng tr\u00ecnh ch\u00ednh trong h\u00e0m loop th\u00ec qu\u00e1 d\u00e0i, n\u1ebfu ch\u00fang ta v\u1eabn s\u1eed d\u1ee5ng ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ecdc input trong h\u00e0m loop th\u00ec b\u1ecb tr\u1ec5. <\/p>\n\n\n\n<p>V\u1edbi ng\u1eaft, b\u1ea1n kh\u00f4ng c\u1ea7n ph\u1ea3i li\u00ean t\u1ee5c ki\u1ec3m tra gi\u00e1 tr\u1ecb pin hi\u1ec7n t\u1ea1i. Khi m\u1ed9t thay \u0111\u1ed5i \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n, m\u1ed9t s\u1ef1 ki\u1ec7n s\u1ebd \u0111\u01b0\u1ee3c k\u00edch ho\u1ea1t &#8211; m\u1ed9t h\u00e0m \u0111\u01b0\u1ee3c g\u1ecdi. Ch\u1ee9c n\u0103ng n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 th\u01b0\u1eddng tr\u00ecnh d\u1ecbch v\u1ee5 ng\u1eaft (ISR).<\/p>\n\n\n\n<p>Do \u0111\u00f3 \u0111\u1ec3 kh\u1eafc ph\u1ee5c \u0111\u01b0\u1ee3c vi\u1ec7c \u0111\u00f3 ch\u00fang ta s\u1eed d\u1ee5ng ng\u1eaft(interrupt), c\u00f3 r\u1ea5t nhi\u1ec1u d\u1ea1ng ng\u1eaft kh\u00e1c nhau nh\u01b0: ng\u1eaft external(ch\u00e2n input), ng\u1eaft nh\u1eadn d\u1eef li\u1ec7u uart, ng\u1eaft timer,&#8230;<\/p>\n\n\n\n<p><strong>C\u01a1 ch\u1ebf ho\u1ea1t \u0111\u1ed9ng c\u1ee7a ng\u1eaft <\/strong><\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" width=\"992\" height=\"291\" src=\"http:\/\/localhost\/wp-content\/uploads\/2020\/09\/interrupt.png\" alt=\"\" class=\"wp-image-185\"\/><\/figure>\n\n\n\n<p>main program \u0111\u1ea1i di\u1ec7n cho h\u00e0m loop, n\u1ebfu ng\u1eaft ch\u01b0a x\u1ea3y ra th\u00ec main program c\u1ee9 th\u1ebf m\u00e0 ch\u1ea1y, \u0111\u1ebfn khi c\u00f3 s\u1ef1 ki\u1ec7n ng\u1eaft th\u00ec chip s\u1ebd d\u1eebng x\u1eed l\u00fd trong ch\u01b0\u01a1ng tr\u00ecnh main v\u00e0 s\u1ebd chuy\u1ec3n \u0111\u1ebfn ch\u01b0\u01a1ng tr\u00ecnh ng\u1eaft \u0111\u1ec3 x\u1eed l\u00fd. Sau khi th\u1ef1c hi\u1ec7n xong trong ch\u01b0\u01a1ng tr\u00ecnh ng\u1eaft, chip s\u1ebd quay v\u1ec1 th\u1ef1c hi\u1ec7n ti\u1ebfp t\u1ee5c v\u1ecb tr\u00ed ch\u01b0\u01a1ng tr\u00ecnh tr\u01b0\u1edbc \u0111\u00f3 trong h\u00e0m main.<\/p>\n\n\n\n<p>B\u00ean d\u01b0\u1edbi s\u1ebd m\u00f4 t\u1ea3 k\u1ef9 h\u01a1n v\u1ec1 qu\u00e1 tr\u00ecnh th\u1ef1c hi\u1ec7n ch\u01b0\u01a1ng tr\u00ecnh ng\u1eaft:<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" width=\"620\" height=\"295\" src=\"http:\/\/localhost\/wp-content\/uploads\/2020\/09\/fig2-interrupt-processing-flow-en.jpg\" alt=\"\" class=\"wp-image-187\"\/><\/figure>\n\n\n\n<p><strong>S\u1eed d\u1ee5ng ng\u1eaft ngo\u00e0i(t\u1eeb ch\u00e2n input) tr\u00ean arduino<\/strong><\/p>\n\n\n\n<p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t 1 ng\u1eaft trong Arduino th\u00ec ch\u00fang ta s\u1eed d\u1ee5ng h\u00e0m attachInterrupt()<\/p>\n\n\n\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"generic\" data-enlighter-theme=\"\" data-enlighter-highlight=\"\" data-enlighter-linenumbers=\"\" data-enlighter-lineoffset=\"\" data-enlighter-title=\"\" data-enlighter-group=\"\">attachInterrupt(digitalPinToInterrupt(GPIO), ISR, mode);<\/pre>\n\n\n\n<p>Trong \u0111\u00f3 <\/p>\n\n\n\n<ul><li>digitalPinToInterrupt(GPIO): g\u00e1n ch\u00e2n IO d\u1ea1ng digital v\u00e0o ch\u00e2n ng\u1eaft, v\u1edbi GPIO l\u00e0 c\u00e1c ch\u00e2n IO tr\u00ean nodemcu<\/li><li>ISR: l\u00e0 t\u00ean c\u1ee7a h\u00e0m \u0111\u01b0\u1ee3c g\u1ecdi khi c\u00f3 ng\u1eaft x\u1ea3y ra<\/li><li>mode: l\u00e0 c\u00e1c ch\u1ebf \u0111\u1ed9 \u0111\u1ec3 k\u00edch ho\u1ea1t ng\u1eaft, ch\u00fang ta c\u00f3 3 ch\u1ebf \u0111\u1ed9: <strong>CHANGE<\/strong>G-khi c\u00f3 s\u1ef1 thay \u0111\u1ed5i c\u1ee7a ch\u00e2n input, <strong>FALLING<\/strong>-khi ch\u00e2n input thay \u0111\u1ed5i tr\u1ea1ng th\u00e1i t\u1eeb cao -> th\u1ea5p v\u00e0 cu\u1ed1i c\u00f9ng <strong>RISING<\/strong>-khi ch\u00e2n input thay \u0111\u1ed5i tr\u1ea1ng th\u00e1i t\u1eeb th\u1ea5p -> cao<\/li><\/ul>\n\n\n\n<p><\/p>\n","protected":false},"excerpt":{"rendered":"<p>C\u00e1c ch\u01b0\u01a1ng tr\u00ecnh tr\u01b0\u1edbc ch\u00fang ta \u0111\u1ec1u vi\u1ebft theo d\u1ea1ng tu\u1ea7n t\u1ef1, ngh\u0129a l\u00e0 c\u00e1c c\u00e2u l\u1ec7nh s\u1ebd ch\u1ea1y l\u1ea7n l\u01b0\u1ee3t trong h\u00e0m loop, sau [&hellip;] <span class=\"read-more-link\"><a class=\"read-more\" href=\"http:\/\/localhost\/2020\/09\/23\/iot-esp8266-05-ngat-va-timer\/\">Xem th\u00eam<\/a><\/span><\/p>\n","protected":false},"author":1,"featured_media":189,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[4],"tags":[8,9,10,11,22,25,28,29,21,24,23],"_links":{"self":[{"href":"http:\/\/localhost\/wp-json\/wp\/v2\/posts\/184"}],"collection":[{"href":"http:\/\/localhost\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/comments?post=184"}],"version-history":[{"count":4,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/posts\/184\/revisions"}],"predecessor-version":[{"id":191,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/posts\/184\/revisions\/191"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/media\/189"}],"wp:attachment":[{"href":"http:\/\/localhost\/wp-json\/wp\/v2\/media?parent=184"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/categories?post=184"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wp-json\/wp\/v2\/tags?post=184"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}